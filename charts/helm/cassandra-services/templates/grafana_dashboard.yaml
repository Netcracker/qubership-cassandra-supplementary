{{- if eq (include "fromValuesThenEnvElseDefault" (dict "dotVar" .Values.monitoringAgent.install "envVar" .Values.MONITORING_ENABLED "default" true )) "true" }}
{{- if eq .Values.monitoringAgent.metricCollector "prometheus" }}
apiVersion: integreatly.org/v1alpha1
kind: GrafanaDashboard
metadata:
  name: cassandra-grafana-dashboard
  labels:
    {{- include "cassandra.defaultLabels" . | nindent 4 }}
    app: grafana
  annotations:
spec:
  name: cassandra-{{ .Release.Namespace }}.json
  gzipJson:  {{ .Files.Get "monitoring/grafana-dashboard.json.gz" | b64enc | quote }}
{{ end }}
{{ end }}
